"use strict";(self.webpackChunkredacted=self.webpackChunkredacted||[]).push([[722],{60:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"usage","title":"Usage","description":"Basic Usage","source":"@site/docs/usage.md","sourceDirName":".","slug":"/usage","permalink":"/redacted/docs/usage","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Usage","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Via library dependencies","permalink":"/redacted/docs/installation/via_libraries_dependencies"},"next":{"title":"How It Works","permalink":"/redacted/docs/how_it_works"}}');var s=n(4848),i=n(8453);const c={title:"Usage",sidebar_position:2},r=void 0,o={},d=[{value:"Basic Usage",id:"basic-usage",level:2},{value:"Quick recap",id:"quick-recap",level:3},{value:"Will it work if ...",id:"will-it-work-if-",level:2},{value:"I nest the case class into another class/object ?",id:"i-nest-the-case-class-into-another-classobject-",level:3},{value:"I use the FQDN of the annotation ?",id:"i-use-the-fqdn-of-the-annotation-",level:3},{value:"I define an alias for <code>@redacted</code> ?",id:"i-define-an-alias-for-redacted-",level:3},{value:"What happens if ...",id:"what-happens-if-",level:2},{value:"the <code>hashCode</code> of a redacted case class is used ?",id:"the-hashcode-of-a-redacted-case-class-is-used-",level:3},{value:"I use it in a curried parameter ?",id:"i-use-it-in-a-curried-parameter-",level:3},{value:"I use it in a method of the case class ?",id:"i-use-it-in-a-method-of-the-case-class-",level:3},{value:"I define a fake <code>redacted</code> annotation ?",id:"i-define-a-fake-redacted-annotation-",level:3}];function l(e){const a={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,s.jsxs)(a.p,{children:["Once you enabled your SBT (sub)project(s) via sbt-plugin (or by manually adding the dependencies), usage of ",(0,s.jsx)(a.code,{children:"@redacted"}),"\nis really straightforward. Assume the (purely educational) scenario where you would like to secure your own\nimplementation for HTTP headers, you could do something like this"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/HttpHeaders.scala"',children:"import io.github.polentino.redacted._\n\nfinal case class HttpHeaders(\n  contentType: String,\n  @redacted userID: Long,\n  @redacetd authorization: String,\n  acceptedLanguage: Set[Locale])\n"})}),"\n",(0,s.jsxs)(a.p,{children:["and now you will be able to log securely to file or console your headers, without fear of leaking by mistake the\n",(0,s.jsx)(a.code,{children:"authorization"})," token or the ",(0,s.jsx)(a.code,{children:"userID"})]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",children:"val httpHeaders: HttpHeaders = // a reference to the http headers of your application\nlogger.debug(httpHeaders)\n"})}),"\n",(0,s.jsx)(a.p,{children:"which will print for example"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",children:"> HttpHeaders(application/json,***,***,Set(ENGLISH))\n"})}),"\n",(0,s.jsx)(a.p,{children:"But that can be a little confusing; if you like, you can also create value classes for sensitive data like passwords,\ntokens, certificates and so on"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/secrets/package.scala"',children:"import io.github.polentino.redacted._\n\npackage object secrets {\n  final case class UserID(@redacted value: Long) extends AnyVal\n  final case class Password(@redacted value: String) extends AnyVal\n  final case class Token(@redacted value: String) extends AnyVal\n  final case class PemCertificate(@redacted bytes: List[Byte]) extends AnyVal\n  // ... other case class definitions for sensitive data\n}\n"})}),"\n",(0,s.jsxs)(a.p,{children:["and change the definition of ",(0,s.jsx)(a.code,{children:"HttpHeaders"})," like so"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/HttpHeaders.scala"',children:"import com.organization.project.secrets._\n\nfinal case class HttpHeaders(\n  contentType: String,\n  userId: UserID,\n  authorization: Token,\n  acceptedLanguage: Set[Locale])\n"})}),"\n",(0,s.jsx)(a.p,{children:"and now, the same example shown above will print this instead"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",children:"> HttpHeaders(application/json,UserID(***),Token(***),Set(ENGLISH))\n"})}),"\n",(0,s.jsx)(a.p,{children:"Looks nicer, right?"}),"\n",(0,s.jsx)(a.h3,{id:"quick-recap",children:"Quick recap"}),"\n",(0,s.jsxs)(a.p,{children:["With the example above, you saw already a few good use cases of how ",(0,s.jsx)(a.code,{children:"@redacted"})," works:"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"it works with case classes"}),"\n",(0,s.jsx)(a.li,{children:"it works with value classes as well"}),"\n",(0,s.jsx)(a.li,{children:"it works with one or more annotated fields"}),"\n"]}),"\n",(0,s.jsx)(a.p,{children:"However, there's more to it: keep reading!"}),"\n",(0,s.jsx)(a.h2,{id:"will-it-work-if-",children:"Will it work if ..."}),"\n",(0,s.jsx)(a.h3,{id:"i-nest-the-case-class-into-another-classobject-",children:"I nest the case class into another class/object ?"}),"\n",(0,s.jsxs)(a.p,{children:["Yes! This is a totally valid, alternate way to write our educational ",(0,s.jsx)(a.code,{children:"HttpHeaders"})," class"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/HttpHeaders.scala"',children:"import HttpHeaders._\n\nfinal case class HttpHeaders(\n  contentType: String,\n  userId: UserID,\n  authorization: Token,\n  acceptedLanguage: Set[Locale])\n\nobject HttpHeaders {\n  final case class UserID(@redacted value: Long) extends AnyVal\n  final case class Password(@redacted value: String) extends AnyVal\n}\n"})}),"\n",(0,s.jsx)(a.h3,{id:"i-use-the-fqdn-of-the-annotation-",children:"I use the FQDN of the annotation ?"}),"\n",(0,s.jsxs)(a.p,{children:["Yes! Once again, here's an alternate way to write our educational ",(0,s.jsx)(a.code,{children:"secrets"})," package object"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/secrets/package.scala"',children:"import io.github.polentino.redacted._\n\npackage object secrets {\n  final case class UserID(@io.github.polentino.redacted.redacted value: Long) extends AnyVal\n  final case class Password(@io.github.polentino.redacted.redacted value: String) extends AnyVal\n  final case class Token(@io.github.polentino.redacted.redacted value: String) extends AnyVal\n  final case class PemCertificate(@io.github.polentino.redacted.redacted bytes: List[Byte]) extends AnyVal\n  // ... other case class definitions for sensitive data\n}\n"})}),"\n",(0,s.jsxs)(a.h3,{id:"i-define-an-alias-for-redacted-",children:["I define an alias for ",(0,s.jsx)(a.code,{children:"@redacted"})," ?"]}),"\n",(0,s.jsxs)(a.p,{children:["Yes! Here's another alternate way to define the ",(0,s.jsx)(a.code,{children:"secrets"})," package object"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/secrets/package.scala"',children:"import io.github.polentino.redacted.{redacted => obfuscated}\n\npackage object secrets {\n  final case class UserID(@obfuscated value: Long) extends AnyVal\n  final case class Password(@obfuscated value: String) extends AnyVal\n  final case class Token(@obfuscated value: String) extends AnyVal\n  final case class PemCertificate(@obfuscated bytes: List[Byte]) extends AnyVal\n  // ... other case class definitions for sensitive data\n}\n"})}),"\n",(0,s.jsx)(a.h2,{id:"what-happens-if-",children:"What happens if ..."}),"\n",(0,s.jsxs)(a.h3,{id:"the-hashcode-of-a-redacted-case-class-is-used-",children:["the ",(0,s.jsx)(a.code,{children:"hashCode"})," of a redacted case class is used ?"]}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.code,{children:"hashCode"})," is essential for hash-based collections such as ",(0,s.jsx)(a.code,{children:"HashMap"}),", ",(0,s.jsx)(a.code,{children:"HashSet"})," and so on, therefore its correctness is\nof utmost importance."]}),"\n",(0,s.jsxs)(a.p,{children:["Since ",(0,s.jsx)(a.code,{children:"@redacted"})," doesn't change the values of the annotated fields, but only the way ",(0,s.jsx)(a.code,{children:"toString"})," is implemented,\n",(0,s.jsx)(a.code,{children:"hashCode"})," remains unaltered."]}),"\n",(0,s.jsx)(a.admonition,{type:"tip",children:(0,s.jsxs)(a.p,{children:["And, just in case, there is also\na ",(0,s.jsx)(a.a,{href:"https://github.com/polentino/redacted/blob/main/tests/src/test/scala/io/github/polentino/redacted/RedactedSpec.scala#L218C1-L219C1",children:"specific test"}),"\nthat ensures the ",(0,s.jsx)(a.code,{children:"hashCode"})," of two similar (in fields definition) case classes, one redacted, the other not, yield the\nsame ",(0,s.jsx)(a.code,{children:"hashCode"})," result."]})}),"\n",(0,s.jsx)(a.h3,{id:"i-use-it-in-a-curried-parameter-",children:"I use it in a curried parameter ?"}),"\n",(0,s.jsx)(a.p,{children:"It won't work."}),"\n",(0,s.jsx)(a.p,{children:"While the following definition is syntactically valid Scala code"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="CurriedParameter.scala"',children:"final case class CurriedParameter(id: Long)(@redacted email: String)\n"})}),"\n",(0,s.jsxs)(a.p,{children:["the field ",(0,s.jsx)(a.code,{children:"email"})," won't contribute at all to the ",(0,s.jsx)(a.code,{children:"toString"})," result, therefore using the annotation is irrelevant."]}),"\n",(0,s.jsx)(a.h3,{id:"i-use-it-in-a-method-of-the-case-class-",children:"I use it in a method of the case class ?"}),"\n",(0,s.jsx)(a.p,{children:"It won't work, and the plugin won't confuse method parameters with case class fields, if that's what you're asking."}),"\n",(0,s.jsxs)(a.p,{children:["For example, this won't redact ",(0,s.jsx)(a.code,{children:"email"})," at all"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="ConfusingParameter.scala"',children:"final case class CurriedParameter(id: Long, email: String) {\n  // WRONG!\n  def toUpper(@redacted email: String): String = ...\n}\n"})}),"\n",(0,s.jsxs)(a.p,{children:["while this will, although it won't affect the ",(0,s.jsx)(a.code,{children:"email"})," parameter of the ",(0,s.jsx)(a.code,{children:"toUpper"})," method"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="ConfusingParameter.scala"',children:"final case class CurriedParameter(id: Long,@redacted email: String) {\n  def toUpper(email: String): String = ...\n}\n"})}),"\n",(0,s.jsxs)(a.h3,{id:"i-define-a-fake-redacted-annotation-",children:["I define a fake ",(0,s.jsx)(a.code,{children:"redacted"})," annotation ?"]}),"\n",(0,s.jsxs)(a.p,{children:["This won't work either. If you try to define a fake ",(0,s.jsx)(a.code,{children:"redacted"})," annotation"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/redacted.scala"',children:"import scala.annotation.StaticAnnotation\n\nclass redacted extends StaticAnnotation\n"})}),"\n",(0,s.jsxs)(a.p,{children:["and then try to use it in our educational ",(0,s.jsx)(a.code,{children:"HttpHeaders"})," case class"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-scala",metastring:'title="com/organization/project/HttpHeaders.scala"',children:"import com.organization.project.redacted\n\nfinal case class HttpHeaders(\n  contentType: String,\n  @redacted userID: Long,\n  @redacetd authorization: String,\n  acceptedLanguage: Set[Locale])\n"})}),"\n",(0,s.jsxs)(a.p,{children:["those annotations ",(0,s.jsx)(a.strong,{children:"won't have any effect"}),"!"]})]})}function h(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,a,n)=>{n.d(a,{R:()=>c,x:()=>r});var t=n(6540);const s={},i=t.createContext(s);function c(e){const a=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(i.Provider,{value:a},e.children)}}}]);